pipelineName: CreateTestPipeline

targets:
  dev: 
    stage: DEV
    default: true
    domain:
      name: cicd-test-domain
      region: ${DEV_DOMAIN_REGION:us-east-2}
    project: 
      name: dev-marketing
  create-test:
    stage: TEST
    domain:
      name: cicd-test-domain
      region: ${DEV_DOMAIN_REGION:us-east-2}
    project:
      name: create-test-project
    initialization:
      project: 
        create: true
        profileName: 'All capabilities'
        owners: [Eng1, arn:aws:iam::058264284947:role/GitHubActionsRole-SMUS-CLI-Tests]
        contributors: []
        userParameters: 
          - EnvironmentConfigurationName: 'Lakehouse Database'
            parameters:
              - name: glueDbName
                value: create_test_db       
      environments: 
        - EnvironmentConfigurationName: 'OnDemand Workflows'
    bundle_target_configuration:
      storage:
        connectionName: default.s3_shared
        directory: 'src'
      workflows:
        connectionName: default.s3_shared
        directory: 'workflows'

workflows:
  - workflowName: simple_dag
    connectionName: project.workflow_mwaa
    engine: MWAA

bundle:
  bundlesDirectory: /tmp/bundles
  workflow:
    - connectionName: default.s3_shared
      append: true
      include: ['workflows']
      exclude: ['.ipynb_checkpoints/', '__pycache__/', '*.pyc']
  storage:
    - connectionName: default.s3_shared
      append: false
      include: ['src']
      exclude: ['.ipynb_checkpoints/', '__pycache__/', '*.pyc']
