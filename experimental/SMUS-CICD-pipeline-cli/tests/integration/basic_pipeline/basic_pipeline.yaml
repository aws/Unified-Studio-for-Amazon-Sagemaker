pipelineName: BasicTestPipeline

workflows:
- workflowName: basic_test_workflow
  connectionName: project.workflow_serverless
  engine: airflow-serverless

bundle:
  bundlesDirectory: /tmp/bundles
  storage:
    - name: code 
      connectionName: default.s3_shared  
      include: 
        - 'code/src'
      exclude: 
        - '.ipynb_checkpoints/'
        - '__pycache__/'
        - '*.pyc'
        - '.libs.json'  
    - name: workflows
      connectionName: default.s3_shared   
      include: ['workflows/']
      exclude: ['.ipynb_checkpoints/', '__pycache__/', '*.pyc']
  git:
    - repository: covid-19-dateset
      url: https://github.com/datasets/covid-19.git

targets:
    dev: 
       stage: DEV
       domain:
         tags:
          purpose: smus-cicd-testing
         region: ${DEV_DOMAIN_REGION:us-east-2}   
       project: 
         name: dev-marketing

    test:
       stage: TEST 
       domain:
         name: BETA_10282025_Domain
         tags:
          purpose: smus-cicd-testing
         region: ${DEV_DOMAIN_REGION:us-east-1}
       project: 
         name: test-marketing
       initialization:
          project: 
            create: True
            owners: 
            - Eng1
            - arn:aws:iam::*:role/GitHubActionsRole-SMUS-CLI-Tests
            contributors: [] 
            role:
              arn: arn:aws:iam::*:role/SMUSCICDTestRole                     
       bundle_target_configuration:
          storage:
            - name: code
              connectionName: default.s3_shared
              targetDirectory: '.'        
            - name: workflows
              connectionName: default.s3_shared
              targetDirectory: '.'   
          git:
            - connectionName: default.s3_shared
              targetDirectory: 'repos'                          