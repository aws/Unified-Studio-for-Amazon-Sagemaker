# SMUS CI/CD Pipeline Manifest
# Generated template with required fields and optional field examples

pipelineName: TestPipeline

domain:
  name: cicd-test-domain
  region: us-east-1

# Bundle configuration (optional)
bundle:
  bundlesDirectory: ./bundles
  workflow:
    - connectionName: default.s3_shared
      include: 
        - 'workflows'
      exclude: 
        - '.ipynb_checkpoints/'
        - '__pycache__/'
        - '*.pyc'
        - '.libs.json'    
  storage:
    - connectionName: default.s3_shared
      include: 
        - '*'
      exclude: 
        - '.ipynb_checkpoints/'
        - '__pycache__/'
        - '*.pyc'
        - '.libs.json'

targets:
  dev:
    stage: DEV
    project:
      name: dev-marketing
      create: false  # Use existing project
    default: true  # Default target for operations
    
    # Bundle target configuration
    bundle_target_configuration:
      storage:
        connectionName: default.s3_shared
        directory: 'src'        
      workflows:
        connectionName: default.s3_shared
        directory: 'workflows'
  
  test:
    stage: TEST
    project:
      name: dev-marketing-test
      create: true  # Auto-create project
    # default: true  # Uncomment to make this the default target
    
    initialization:
      project:
        create: true
        profileName: 'All capabilities'
        owners: [arn:aws:iam::123456789012:role/GitHubActionsRole-SMUS-CLI-Tests]
        contributors: []
    
    # Bundle target configuration
    bundle_target_configuration:
      storage:
        connectionName: default.s3_shared
        directory: 'src'        
      workflows:
        connectionName: default.s3_shared
        directory: 'workflows'
  
  prod:
    stage: PROD
    project:
      name: dev-marketing-prod
      create: true  # Auto-create project
    # default: true  # Uncomment to make this the default target
    
    initialization:
      project:
        create: true
        profileName: 'All capabilities'
        owners: [arn:aws:iam::123456789012:role/GitHubActionsRole-SMUS-CLI-Tests]
        contributors: []
    
    # Bundle target configuration
    bundle_target_configuration:
      storage:
        connectionName: default.s3_shared
        directory: 'src'        
      workflows:
        connectionName: default.s3_shared
        directory: 'workflows'
  

# Workflows configuration (optional)
# workflows:
#   - workflowName: your_workflow_name
#     connectionName: project.workflow_mwaa
#     triggerPostDeployment: true
#     logging: console
#     engine: MWAA
#     # parameters:
#     #   env: production
#     #   timeout: 3600
#   
#   - workflowName: another_workflow
#     connectionName: project.workflow_mwaa
#     triggerPostDeployment: false
#     logging: none
#     engine: MWAA
